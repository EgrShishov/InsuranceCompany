{% extends 'common/layout.html' %}
{% block content%}
<section class="account-cart">
    <h1>Корзина заявок</h1>

    {% if cart %}
        <table class="">
            <thead>
                <tr>
                    <th>Страховая сумма</th>
                    <th>ФИО Агента</th>
                    <th>Количество</th>
                    <th>Объект</th>
                    <th>Действия</th>
                </tr>
            </thead>
            <tbody>
                {% for item in cart %}
                <tr>
                    <td>${{ item.sum }}</td>
                    <td>{{ item.agent }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>{{ item.object }}</td>
                    <td>
                        <div align="right">
                            <form method="POST" action="{% url 'remove_from_cart' item.id %}">
                                {% csrf_token %}
                                <button type="submit">Удалить</button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="checkout-bar">
            <p id="checkout-total">Итого: $<span id="total">{{ total_price }}</span></p>

            <label for="promo_code">Промокод</label>
            <input type="text" id="promo_code" name="promo_code">
            <button type="button" id="apply_promo" onclick="applyPromocode()">Применить</button>
            <button type="button" id="cancel_promo" onclick="cancelPromocode()">Отменить</button>

            <form method="POST" action="{% url 'checkout' %}">
                {% csrf_token %}
                <button type="submit">На страницу оплаты</button>
            </form>
            <a href="javascript:history.back()">Назад</a>
        </div>
    {% else %}
        <p>Корзина пуста.</p>
    {% endif %}
</section>
{% endblock %}